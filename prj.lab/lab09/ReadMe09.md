## **Лабораторная 09** (Серый мир)
Цветокоррекция gray world реализовать, оценить качество и сравнить

## **Отчет09**

Функционал:

    cv::Mat grayWorld(const cv::Mat& src) - Функция Gray World для выравнивания баланса белого, путем нахождения простого средне арифметического.

    cv::Mat autoContrast(const cv::Mat& src) - Функция автоконтрастирования, принимает картинку и выдает после контрастирования, необходимо для проведения сравнения с другим методом

    cv::Mat computeSSIM(const cv::Mat& img1, const cv::Mat& img2, double& ssim_value) - Функция для вычисления SSIM (SSIM - метрика сходства, значение которой показывает процент сходства картинок по следующим параметрам: яркости, контрастности и структуры. Абстрактно, формула SSIM может быть показана как взвешенное произведение яркости, контраста и структуры, вычисленных независимо.)

    double computePSNR(const cv::Mat& img1, const cv::Mat& img2) - функция вычисления PSNR. Данная метрика показывает абсолютное отклонение по ключевым точкам в шуме или яркости.

    cv::Mat linearizeRGB(const cv::Mat& src) - функция для linRGB преобразования

**Результат:**

Для выполнения лабораторной было взято 3 картинки разной цветовой палитры и насыщенности. Далее я покажу полный цикл на картике "Собака", после чего на остальных картинках будет показан только эффект применения функций контрастирования и оценка качества.

### Полный цикл

#### Обработка изображения
Было выбрано исходное изображение:

![Dog](/prj.lab/lab09/Dog/Собака.jpg)

Исходное изображение было преобразовано в линейное RGB с коррекцией гамма (gamma = 1.9):

![linRGB](/prj.lab/lab09/Dog/linRGB_grayWorld.png)

Далее независимо друг от друга применяются функции автоконтрастирования и grayWorld.Применение метода Gray World для выравнивания баланса белого:

![grayWorld](/prj.lab/lab09/Dog/resultGrayWorld.png)

Результат автоматической коррекции контраста:

![AutoContr](/prj.lab/lab09/Dog/outputAutoContrast.png)

#### Вычисление оценки


Вычисление SSIM, PSNR между оригинальным изображением и результатами Gray World и автоконтрастирования производится с помощью соответствующих функций, а их результат выводится отдельной картинкой:

![SSIM](/prj.lab/lab09/Dog/QualityMetrics.png)


#### Картинка "Листья"
Оригинальная картинка:

![Orig](/prj.lab/lab09/Leaves/Листья.jpg)

Применение метода Gray World для выравнивания баланса белого:

![grayWorld](/prj.lab/lab09/Leaves/resultGrayWorld.png)

Результат автоматической коррекции контраста:

![AutoContr](/prj.lab/lab09/Leaves/outputAutoContrast.png)

Вычисление SSIM, PSNR:

![SSIM](/prj.lab/lab09/Leaves/QualityMetrics.png)


#### Картинка "Кровля"
Оригинальная картинка:

![Orig](/prj.lab/lab09/Colors/Кровля.jpg)

Применение метода Gray World для выравнивания баланса белого:

![grayWorld](/prj.lab/lab09/Colors/resultGrayWorld.png)

Результат автоматической коррекции контраста:

![AutoContr](/prj.lab/lab09/Colors/outputAutoContrast.png)

Вычисление SSIM, PSNR:

![SSIM](/prj.lab/lab09/Colors/QualityMetrics.png)


### Сравнение

По результатам работы программы можно наблюдать следующее:
Автоконтраст ближе похож на оригинальную картинку, чем grayWorld, такие данные также показывает метрика SSIM, которая больше ориентируется на среднее значений всех возможных отклонений. Но при этом, функция grayWorld делает так, чтобы другая метрика, ориентирующаяся на "шум" и пики показывала большую схожесть именно этого метода. Эти данные еще раз позволяют убедиться в эффекте сглаживания со стороны второго метода.
